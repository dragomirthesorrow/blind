#!/bin/bash 

#this script gets params from auto_conf.php and create configs for phones.

#mac
mac=$1
#number
number=$2
#name of user
name=$3

#set the output filename
dfile='/var/www/html/tel_configs/cfg'${mac}'.xml'

#start the construction
cat <<EOF >>$dfile
<?xml version="1.0" encoding="UTF-8" ?>
<gs_provision version="1">
<mac>${mac}</mac>
<config version="1">
<P570>25</P570>
<P695>1</P695>
<P571>20</P571>
<P696>101</P696>
<P697>2</P697>
<P698>1</P698>
<P610>1</P610>
<P611>0</P611>
<P290>{ x+ | *x+ | *xx*x+ }</P290>
<P451>0</P451>
<P576>60</P576>
<P612>60</P612>
<P291>0</P291>
<P613>5066</P613>
<P452>8</P452>
<P614>0</P614>
<P453>4</P453>
<P615>0</P615>
<P454>18</P454>
<P330>0</P330>
<P455>9</P455>
<P456>98</P456>
<P332>0</P332>
<P457>2</P457>
<P333>1</P333>
<P298>0</P298>
<P334>6</P334>
<P459>{ x+ | *x+ | *xx*x+ }</P459>
<P90>0</P90>
<P335>2</P335>
<P91>0</P91>
<P2623>0</P2623>
<P92>0</P92>
<P212>1</P212>
<P2624>0</P2624>
<P1339>0</P1339>
<P338>0</P338>
<P2625>0</P2625>
<P93>0</P93>
<P2340>confirmed_</P2340>
<P94>0</P94>
<P2501>0</P2501>
<P2341>0</P2341>
<P95>0</P95>
<P2502>1</P2502>
<P96>97</P96>
<P2342>0</P2342>
<P2503>0</P2503>
<P97>1</P97>
<P2343>0</P2343>
<P2629>1</P2629>
<P2504>0</P2504>
<P2505>0</P2505>
<P10>168</P10>
<P99>0</P99>
<P2506>0</P2506>
<P11>0</P11>
<P2346>0</P2346>
<P12>160</P12>
<P2347>0</P2347>
<P13>255</P13>
<P2348>0</P2348>
<P14>255</P14>
<P15>0</P15>
<P901>80</P901>
<P16>0</P16>
<P17>0</P17>
<P18>0</P18>
<P581>**</P581>
<P8020>10.0.0.16</P8020>
<P19>0</P19>
<P8021>389</P8021>
<P8022>OU>User,DC>corp,DC>digital-grass,DC>ru</P8022>
<P620>1</P620>
<P8023>oadm</P8023>
<P460>0</P460>
<P585>0</P585>
<P621>0</P621>
<P8024>Dcbsm17J</P8024>
<P8025>(telephoneNumber>%)</P8025>
<P586>2</P586>
<P622>0</P622>
<P623>0</P623>
<P8026>(|(cn>%)(sn>%))</P8026>
<P624>100</P624>
<P588>0</P588>
<P8027>3</P8027>
<P1464>0</P1464>
<P1340>0</P1340>
<P589>1</P589>
<P1501>0</P1501>
<P625>0</P625>
<P8028>cn</P8028>
<P340>0</P340>
<P1341>0</P1341>
<P501>1</P501>
<P8029>telephoneNumber</P8029>
<P1503>0</P1503>
<P627>90</P627>
<P1343>0</P1343>
<P342>0</P342>
<P628>0</P628>
<P182>0</P182>
<P2630>0</P2630>
<P343>f1>350,f2>440;</P343>
<P1505>0</P1505>
<P629>0</P629>
<P183>0</P183>
<P1345>0</P1345>
<P2631>0</P2631>
<P344>f1>350,f2>440,c>10/10;</P344>
<P469>0</P469>
<P184>0</P184>
<P345>f1>440,f2>480,c>200/400;</P345>
<P1507>0</P1507>
<P346>f1>440,f2>480,c>200/400;</P346>
<P1347>**</P1347>
<P508>0</P508>
<P186>0</P186>
<P347>f1>440,f2>440,c>25/525;</P347>
<P1509>0</P1509>
<P1349>P@ssw0rd</P1349>
<P348>f1>480,f2>620,c>50/50;</P348>
<P509>0</P509>
<P188>0</P188>
<P2511>0</P2511>
<P349>f1>480,f2>620,c>25/25;</P349>
<P3>${name}</P3>
<P2513>15</P2513>
<P2638>0</P2638>
<P102>0</P102>
<P2639>0</P2639>
<P103>0</P103>
<P104>0</P104>
<P8>0</P8>
<P20>0</P20>
<P9>192</P9>
<P21>0</P21>
<P22>0</P22>
<P23>0</P23>
<P2519>0</P2519>
<P24>0</P24>
<P25>0</P25>
<P26>0</P26>
<P27>0</P27>
<P28>0</P28>
<P591>4</P591>
<P8030>%cn %telephoneNumber</P8030>
<P29>0</P29>
<P592>1</P592>
<P8031>50</P8031>
<P8032>30</P8032>
<P593>1</P593>
<P8033>0</P8033>
<P594>97</P594>
<P630>0</P630>
<P470>20</P470>
<P8034>1</P8034>
<P595>1</P595>
<P631>0</P631>
<P8035>1</P8035>
<P471>20</P471>
<P596>101</P596>
<P632>0</P632>
<P597>2</P597>
<P633>1</P633>
<P598>1</P598>
<P634>180</P634>
<P510>1</P510>
<P635>0</P635>
<P1511>0</P1511>
<P511>0</P511>
<P351>0</P351>
<P476>60</P476>
<P512>60</P512>
<P191>1</P191>
<P513>5064</P513>
<P638>0</P638>
<P2640>0</P2640>
<P192>firmware.grandstream.com</P192>
<P514>0</P514>
<P2641>0</P2641>
<P193>10080</P193>
<P515>0</P515>
<P2642>0</P2642>
<P194>0</P194>
<P1357>0</P1357>
<P2643>0</P2643>
<P231>1</P231>
<P234></P234>
<P198>100</P198>
<P2646>0</P2646>
<P2647>0</P2647>
<P2523>0</P2523>
<P2648>0</P2648>
<P237>10.0.0.55</P237>
<P2524>0</P2524>
<P2525>0</P2525>
<P238>0</P238>
<P30>10.0.0.16</P30>
<P2401>0</P2401>
<P31>1</P31>
<P2402>1</P2402>
<P32>60</P32>
<P2403>0</P2403>
<P2529>1</P2529>
<P2404>0</P2404>
<P2405>0</P2405>
<P2406>0</P2406>
<P35>${number}</P35>
<P36>${number}</P36>
<P37>2</P37>
<P38>12</P38>
<P39>5004</P39>
<P640>50</P640>
<P641>400</P641>
<P642>0</P642>
<P481>**</P481>
<P643>0</P643>
<P1485>30</P1485>
<P520>1</P520>
<P485>0</P485>
<P521>0</P521>
<P646>0</P646>
<P1487>0</P1487>
<P1362>auto</P1362>
<P486>2</P486>
<P522>0</P522>
<P648>0</P648>
<P1363>0</P1363>
<P523>0</P523>
<P524>100</P524>
<P488>0</P488>
<P1364>0</P1364>
<P1489>0</P1489>
<P649>0</P649>
<P1526>0</P1526>
<P1365>0</P1365>
<P489>1</P489>
<P525>0</P525>
<P401>1</P401>
<P1366>0</P1366>
<P240>0</P240>
<P1402>1</P1402>
<P1367>0</P1367>
<P1403>1</P1403>
<P527>90</P527>
<P1368>0</P1368>
<P1404>1</P1404>
<P528>0</P528>
<P1369>0</P1369>
<P1405>1</P1405>
<P2530>0</P2530>
<P529>0</P529>
<P1406>0</P1406>
<P2531>0</P2531>
<P246>MTZ+6MDT+5,M4.1.0,M11.1.0</P246>
<P1408>1</P1408>
<P1409>0</P1409>
<P122>0</P122>
<P408>0</P408>
<P409>0</P409>
<P40>5061</P40>
<P2411>0</P2411>
<P2413>15</P2413>
<P2538>0</P2538>
<P2539>0</P2539>
<P129>0</P129>
<P46>2</P46>
<P47>10.0.0.51:5061</P47>
<P2419>0</P2419>
<P49>1</P49>
<P651>0</P651>
<P1491>0</P1491>
<P491>4</P491>
<P652>8</P652>
<P492>1</P492>
<P1493>0</P1493>
<P653>4</P653>
<P493>1</P493>
<P654>18</P654>
<P1370>0</P1370>
<P494>97</P494>
<P1495>0</P1495>
<P530>0</P530>
<P655>9</P655>
<P495>1</P495>
<P531>0</P531>
<P656>98</P656>
<P496>101</P496>
<P1497>0</P1497>
<P532>0</P532>
<P657>2</P657>
<P497>2</P497>
<P533>1</P533>
<P1410>1</P1410>
<P498>1</P498>
<P1499>0</P1499>
<P534>180</P534>
<P659>{ x+ | *x+ | *xx*x+ }</P659>
<P1411>0</P1411>
<P410>1</P410>
<P535>0</P535>
<P1376>0</P1376>
<P250>400</P250>
<P411>0</P411>
<P412>60</P412>
<P1378>15</P1378>
<P413>5062</P413>
<P538>0</P538>
<P2540>0</P2540>
<P1379>auto</P1379>
<P1415>0</P1415>
<P414>0</P414>
<P2541>0</P2541>
<P415>0</P415>
<P130>0</P130>
<P2542>0</P2542>
<P2543>0</P2543>
<P132>2</P132>
<P9997>nouse</P9997>
<P7050>0</P7050>
<P258>0</P258>
<P133>1</P133>
<P50>0</P50>
<P9999>0</P9999>
<P2546>0</P2546>
<P135>0</P135>
<P51>0</P51>
<P2547>0</P2547>
<P7053>1</P7053>
<P52>0</P52>
<P2423>0</P2423>
<P2548>0</P2548>
<P7055>0</P7055>
<P2424>0</P2424>
<P138>20</P138>
<P2425>0</P2425>
<P2301>0</P2301>
<P139>20</P139>
<P2302>1</P2302>
<P57>0</P57>
<P2303>0</P2303>
<P58>8</P58>
<P2429>1</P2429>
<P2304>0</P2304>
<P59>4</P59>
<P2305>0</P2305>
<P2306>0</P2306>
<P660>0</P660>
<P7901>0</P7901>
<P1380>DJI;.IXIC;INX;.FTSE;.STOXX50E;.FCHI;.N225;.BSESN;.HSI;.TWII</P1380>
<P540>50</P540>
<P1381>EUR/USD;GBP/USD;CAD/USD;AUD/USD;CNY/USD;JPY/USD</P1381>
<P541>400</P541>
<P1382>1</P1382>
<P542>0</P542>
<P543>0</P543>
<P1384>0</P1384>
<P669>0</P669>
<P1385>0</P1385>
<P420>1</P420>
<P260>180</P260>
<P421>0</P421>
<P546>0</P546>
<P261>90</P261>
<P1387>0</P1387>
<P422>0</P422>
<P262>0</P262>
<P548>0</P548>
<P423>0</P423>
<P263>0</P263>
<P424>100</P424>
<P549>0</P549>
<P264>0</P264>
<P1301>0</P1301>
<P425>0</P425>
<P265>0</P265>
<P301>0</P301>
<P1302>0</P1302>
<P266>0</P266>
<P427>90</P427>
<P267>1</P267>
<P428>0</P428>
<P304>0</P304>
<P143>1</P143>
<P2430>0</P2430>
<P429>0</P429>
<P60>18</P60>
<P144>1</P144>
<P2431>0</P2431>
<P61>9</P61>
<P145>1</P145>
<P62>98</P62>
<P307>0</P307>
<P63>0</P63>
<P148>Grandstream GXP2100</P148>
<P64>EET-2EEST,M3.5.0/3,M10.5.0/4</P64>
<P65>0</P65>
<P2311>0</P2311>
<P2313>15</P2313>
<P2438>0</P2438>
<P2439>0</P2439>
<P670>20</P670>
<P671>20</P671>
<P2319>0</P2319>
<P551>0</P551>
<P676>60</P676>
<P552>8</P552>
<P553>4</P553>
<P1555>0</P1555>
<P554>18</P554>
<P430>0</P430>
<P555>9</P555>
<P431>0</P431>
<P556>98</P556>
<P270>${name}</P270>
<P1433>300</P1433>
<P271>1</P271>
<P432>0</P432>
<P557>2</P557>
<P1434>200</P1434>
<P272>0</P272>
<P433>1</P433>
<P1310>0</P1310>
<P434>180</P434>
<P559>{ x+ | *x+ | *xx*x+ }</P559>
<P1311>0</P1311>
<P310>0</P310>
<P435>0</P435>
<P1312>0</P1312>
<P276>0</P276>
<P1438>1</P1438>
<P313>0</P313>
<P1439>0</P1439>
<P438>0</P438>
<P2440>0</P2440>
<P2601>0</P2601>
<P2441>0</P2441>
<P2602>1</P2602>
<P2442>0</P2442>
<P316>0</P316>
<P2603>0</P2603>
<P2443>0</P2443>
<P72>1</P72>
<P2604>0</P2604>
<P2605>0</P2605>
<P319>0</P319>
<P2606>0</P2606>
<P2446>0</P2446>
<P2447>0</P2447>
<P2323>0</P2323>
<P2448>0</P2448>
<P2324>0</P2324>
<P78>0</P78>
<P79>101</P79>
<P2325>0</P2325>
<P681>**</P681>
<P2329>1</P2329>
<P560>0</P560>
<P685>0</P685>
<P686>2</P686>
<P688>0</P688>
<P689>1</P689>
<P601>1</P601>
<P440>50</P440>
<P441>400</P441>
<P442>0</P442>
<P443>0</P443>
<P569>0</P569>
<P285>1</P285>
<P446>0</P446>
<P286>1</P286>
<P608>0</P608>
<P4506>0</P4506>
<P448>0</P448>
<P323>0</P323>
<P609>0</P609>
<P324>0</P324>
<P4507>86400</P4507>
<P288>1</P288>
<P2611>0</P2611>
<P449>0</P449>
<P325>0</P325>
<P326>0</P326>
<P81>0</P81>
<P2613>15</P2613>
<P1328>60</P1328>
<P327>0</P327>
<P1329>10</P1329>
<P328>0</P328>
<P329>0</P329>
<P2330>0</P2330>
<P84>20</P84>
<P85>4</P85>
<P2331>0</P2331>
<P87>0</P87>
<P2619>0</P2619>
<P208>0</P208>
<P88>0</P88>
<P209>50</P209>
<P2338>0</P2338>
<P691>4</P691>
<P692>1</P692>
<P2339>0</P2339>
<P693>1</P693>
</config>
</gs_provision>
EOF
cfile='/var/www/html/tel_configs/confirmed_cfg'${mac}'.xml'
openssl enc -e -aes-256-cbc -k 123456 -in $dfile -out $cfile
chmod 777 $cfile
chmod 777 $dfile
#rm $dfile
